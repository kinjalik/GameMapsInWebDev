"use strict";var _createClass=function(){function t(e,o){for(var a=0;a<o.length;a++){var t=o[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(e,o,a){return o&&t(e.prototype,o),a&&t(e,a),e}}();function _classCallCheck(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}var Debug=function(){function a(e,o){_classCallCheck(this,a),this.isDebug=Boolean(e),this.settings=o||{},1==this.settings.showCoordinates&&this.showCoordinates()}return _createClass(a,[{key:"showCoordinates",value:function(){var o=this,a=L.popup();mymap.addEventListener("click",function(e){!0===o.settings.showCoordinates&&1==o.status&&a.setLatLng(e.latlng).setContent("\n          <p>\n            <b>Coordinates</b><br>\n            <b>Lat:</b> "+SanAndreas.coordsTranslator("array",e.latlng)[0]+"<br>\n            <b>Lng:</b> "+SanAndreas.coordsTranslator("array",e.latlng)[1]+"<br>\n            <i>"+SanAndreas.coordsTranslator("array",e.latlng).toString()+"</i>\n          </p>\n          ").openOn(mymap)})}},{key:"log",value:function(e,o,a){if(0==this.status||0==this.settings.logging)return!1;switch(e){case"error":console.error(o,a);break;case"warn":console.warn(o,a);break;case"info":case"log":console.info(o,a)}}},{key:"status",get:function(){return this.isDebug},set:function(e){this.isDebug=Boolean(e)}},{key:"options",get:function(){return this.settings},set:function(e){void 0!==e.showCoordinates&&(this.settings.showCoordinates=Boolean(e.showCoordinates),this.showCoordinates()),void 0!==e.logging&&(this.settings.logging=Boolean(e.logging))}}]),a}(),debug=new Debug(!1),SanAndreas={maps:{SASat:L.tileLayer("maps/SASat/{z}/{x}/{y}.png",{attribution:"San Andreas Satellite Map",minZoom:1,maxZoom:5,continuousWorld:!1,noWrap:!0}),SARoad:L.tileLayer("maps/SARoad/{z}/{x}/{y}.png",{attribution:"San Andreas Atlus Map",minZoom:1,maxZoom:5,continuousWorld:!1,noWrap:!0})},crs:L.extend({},L.CRS.Simple,{transformation:new L.Transformation(.04266666666,127.99999998,-.04266666666,127.99999998)}),coordsTranslator:function(e,o){if(o instanceof Object&&!(o instanceof Array))switch(debug.log("log","Coords converter got:","Object"),e){case"object":return{lat:o.lng.toFixed(4),lng:o.lat.toFixed(4)};case"array":return[o.lng.toFixed(4),o.lat.toFixed(4)]}else if(o instanceof Array)switch(debug.log("log","Coords converter got:","Array"),e){case"object":return{lat:o[1].toFixed(4),lng:o[0].toFixed(4)};case"array":return[o[1].toFixed(4),o[0].toFixed(4)]}else debug.log("error","Coordinates are not correct","")}},mymap=L.map("mapid",{crs:SanAndreas.crs,maxBounds:[[3500,3500],[-3500,-3500]],layers:[SanAndreas.maps.SASat]});mymap.setView([0,0],2),debug.options={showCoordinates:!1};var layers={Satellite:SanAndreas.maps.SASat,Road:SanAndreas.maps.SARoad},editPanelShown=!1;function editMap(){if(!editPanelShown){editPanelShown=!0;var e=new L.FeatureGroup;mymap.addLayer(e);new L.Control.Draw({edit:{featureGroup:e}});mymap.addControl(new L.Control.Draw({edit:{featureGroup:e,poly:{allowIntersection:!1}},draw:{polygon:{allowIntersection:!1,showArea:!0}}})),mymap.on(L.Draw.Event.CREATED,function(e){var o=e.layer;o.addTo(mymap);var a=JSON.stringify(o.toGeoJSON());debug.log("info","GeoJSON:",a)})}}L.easyButton('<i class="fas fa-edit"></i>',function(){editMap()}).addTo(mymap);var Areas=function(){function a(e,o){_classCallCheck(this,a),this.areasGeoJSON=this.getJson(e),debug.log("info","Areas GeoJSON:",this.areasGeoJSON),this.layer=this.drawLayer(this.areasGeoJSON,o),debug.log("info","Areas Layer:",this.layer)}return _createClass(a,[{key:"getJson",value:function(e){var o=new XMLHttpRequest;if(o.open("GET",e,!1),o.send(),200==o.status)return JSON.parse(o.responseText);debug.log("error","Areas GeoJSON request failed.\n",o.status+": "+o.statusText)}},{key:"drawLayer",value:function(e,o){var a=L.geoJSON(e,{style:function(e){switch(e.properties.color){case"blue":return{color:"#00a8ff"};case"green":return{color:"#4cd137"};case"red":return{color:"#e84118"}}},onEachFeature:function(e,o){o.bindTooltip(e.properties.name)}});return o&&a.addTo(mymap),a}}]),a}(),areas=new Areas("json/SA_Police_Jursidictions.json"),Places=function(){function a(e,o){_classCallCheck(this,a),this.GeoJSON=this.getJson(e),debug.log("info","Places GeoJSON:",this.GeoJSON),this.layer=this.drawLayer(this.GeoJSON,o),debug.log("info","Places layer:",this.layer)}return _createClass(a,[{key:"getJson",value:function(e){var o=new XMLHttpRequest;if(o.open("GET",e,!1),o.send(),200==o.status)return JSON.parse(o.responseText);debug.log("error","Areas GeoJSON request failed.\n",o.status+": "+o.statusText)}},{key:"drawLayer",value:function(e,o){var a=L.geoJSON(e,{onEachFeature:function(e,o){o.bindPopup("\n            <b>"+e.properties.name+"</b><br>\n            <p>"+e.properties.description+"</p>\n          ").setIcon(L.icon({iconUrl:"img/icons/"+e.properties.icon+".png",iconSize:[16,16]}))}});return o&&a.addTo(mymap),a}}]),a}(),places=new Places("json/SA_places.json",!0),overlays={"Police Jurisdictions":areas.layer,Locations:places.layer};L.control.layers(layers,overlays,{collapsed:!1}).addTo(mymap),debug.status=!0,debug.options={showCoordinates:!0};