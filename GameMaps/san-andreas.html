<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Map</title>
  <link rel="stylesheet" href='css/leaflet.css'>
  <link rel="stylesheet" href="css/leaflet.draw.css">
  <link rel="stylesheet" href="css/easy-button.css">
  <script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
  <style>
  body {
    padding: 0;
    margin: 0;
  }

  #mapid {
    width: 100vw;
    height: 100vh;
    background: #6e9ecc;
  }
  </style>
</head>

<body>
  <div id="mapid"></div>
  <script src="js/leaflet.js"></script>
  <script src='js/leaflet.draw.js'></script>
  <script src="js/easy-button.js"></script>
  <script>
  let SanAndreas = {
    maps: {
      SASat: L.tileLayer('maps/SASat/{z}/{x}/{y}.png', {
        attribution: 'San Andreas Satellite Map',
        minZoom: 1,
        maxZoom: 5,
        continuousWorld: false,
        noWrap: true
      }),
      SARoad: L.tileLayer('maps/SARoad/{z}/{x}/{y}.png', {
        attribution: 'San Andreas Atlus Map',
        minZoom: 1,
        maxZoom: 5,
        continuousWorld: false,
        noWrap: true
      })
    },
    crs: L.extend({}, L.CRS.Simple, {
      transformation: new L.Transformation(0.04266666666, 127.99999998, 0.04266666666, 127.99999998),
    }),
  }

  let mymap = L.map('mapid', {
    crs: SanAndreas.crs,
    maxBounds: [
      [3500, 3500],
      [-3500, -3500]
    ],
    layers: [SanAndreas.maps.SASat]
  });
  mymap.setView([0, 0], 2);

  let layers = {
    'Satellite': SanAndreas.maps.SASat,
    'Road': SanAndreas.maps.SARoad
  }

  L.control.layers(layers).addTo(mymap);

  var marker = L.marker([0, 0]).addTo(mymap).bindPopup('Popup');

  let editPanelShown = false;
  function editMap() {
    if (!editPanelShown) {
      editPanelShown = true;
      var drawnItems = new L.FeatureGroup();
      mymap.addLayer(drawnItems);
      var drawControl = new L.Control.Draw({
        edit: {
          featureGroup: drawnItems
        }
      });

      mymap.addControl(new L.Control.Draw({
        edit: {
          featureGroup: drawnItems,
          poly: {
            allowIntersection: false
          }
        },
        draw: {
          polygon: {
            allowIntersection: false,
            showArea: true
          }
        }
      }));

      mymap.on(L.Draw.Event.CREATED, function(event) {
        var layer = event.layer;

        layer.addTo(mymap);

        let test = JSON.stringify(layer.toGeoJSON());
        console.log(test);
      });
    }
  }

  L.easyButton('<i class="fas fa-edit"></i>', function() {
    editMap();
  }).addTo(mymap);
  </script>
</body>

</html>